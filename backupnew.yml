---
  - name: get data
    shell: cat /runner/project/time
    register: time_info
    delegate_to: localhost

  - set_fact: papka="{{ inventory_hostname }}"
    
  - set_fact: imy="{{ inventory_hostname + "_" + time_info.stdout }}"

  - name: Запись конфигурации в строку
    shell: cat /runner/project/backups/{{papka}}/{{imy + ".old"}}.rsc
    register: cfgold

  - name: Export in variable
    community.routeros.command:
      commands:
        - /export
      register: cfgnew     

  - set_fact: difer="True"
    when: cfgold.stdout_lines[1:] != cfgnew.stdout_lines[1:]

  - name: Export to file
    community.routeros.command:
      commands:
        - /export file="{{  papka + ".new" }}"  
    when: difer == "True"    

  - name: Get export in server
    ansible.netcommon.net_get:
      protocol: sftp
      src: /{{papka + ".new"}}.rsc
      dest: /runner/project/backups/{{papka}}/{{imy + ".new"}}.rsc  
      ignore_errors: true
    when: difer == "True"
      
      
  
